fork https://go-review.googlesource.com/c/go/+/425187